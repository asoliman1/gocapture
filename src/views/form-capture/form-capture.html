<ion-header>
	<ion-navbar color="primary" #navbar>

    <ion-title>
      <div #formTitle (click)="onOpenStations()">
        <!-- A.S GOC-321 -->
        {{form ? form.name + ' (' + getFormSubmissions() + ')' : ''}}
        <br *ngIf="form?.event_stations?.length" >
        <span *ngIf="selectedStation" >{{selectedStation.name}} <ion-icon class="info-icon" name="ios-information-circle-outline"></ion-icon></span>
        <br>
      </div>
    </ion-title>

    <ion-buttons end>
			<button ion-button  (click)="doSave()" *ngIf="!isReadOnly(submission) && !isEditing" [disabled]="isProcessing">
				{{'form-capture.submit-btn' | translate}}
			</button>

      <button ion-button *ngIf="isAllowedToEdit(submission) && !isEditing" (click)="doEdit()">
        {{'form-capture.edit-btn' | translate}}
      </button>

      <button ion-button *ngIf="isAllowedToEdit(submission) && isEditing" (click)="doSave()">
        {{'form-capture.update-btn' | translate}}
      </button>

		</ion-buttons>
	</ion-navbar>

  <ion-toolbar *ngIf="isReadOnly(submission)">
    <div class="info-box">
      <div class="description-info">
        {{submission | submissionStatusPipe | translate}}
      </div>
      <div class="date-info">
        {{'form-capture.date-info' | translate}} {{submissionDate()}}
      </div>
    </div>
  </ion-toolbar>

  <ion-toolbar *ngIf="errorMessage.text">
    <div class="error-message" >{{errorMessage.text | translate : {fields:(errorMessage.param)} }}</div>
  </ion-toolbar>
</ion-header>

<!-- A.S GOC-353 -->
<ion-content [ngStyle]="{
  'background-color':form?.event_style?.capture_background_color,
  'background-image':'url('+captureBg+')',
  'background-size':'cover',
  'background-position':'center'}" class="form-summary">
	<ion-grid>
		<ion-row *ngIf="form && form.list_id > 0 && !isReadOnly(submission) && !activation">
			<ion-col>
      <button ion-button block color="light" [ngStyle]="{'background-color':form.search_list_background_color,'color':form.search_list_text_color}" (click)="searchProspect()"><ion-icon name="search"></ion-icon>&nbsp;&nbsp;&nbsp;{{'form-capture.search-list' | translate}}</button>
			</ion-col>
		</ion-row>

		<ion-row>
      <ion-col style="order:1"Â >
        <form-view
          *ngIf="form"
          [form]="form"
          [prospect]="prospect"
          [submission]="submission"
          (onValidationChange)="onValidationChange($event)"
          [readOnly]="isReadOnly(submission) && !isEditing"
          [isEditing]="isEditing"
          [submitAttempt]="submitAttempt"
          (onProcessingEvent)="onProcessing($event)"
          >
        </form-view>
      </ion-col>
      <ion-col *ngIf="activation && activation.display_capture_form != 1" [style.order]="getCaptureScreenUrlOrder(activation.display_capture_form)" >
        <iframe [src]="activation.capture_screen_url | safeUrl" width="100%" height="100%" frameborder="0" ></iframe>
      </ion-col>
    </ion-row>

	</ion-grid>
</ion-content>
<button-bar
*ngIf="form && !activation" 
[show]="!isReadOnly(submission) || isEditing" 
[disabled]="isProcessing" 
[form]="form" >
</button-bar>

